generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

enum USER_TYPES {
  user
  admin
}

enum FREQUENCY {
  monthly
  yearly
  unlimited
}

model Country {
  id        String   @id @default(auto()) @map("_id") @db.ObjectId
  ISOCode   String
  name      String
  phoneCode Int
  User      User[]
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Plan {
  id          String    @id @default(auto()) @map("_id") @db.ObjectId
  title       String
  description String
  globalPrice Float
  egPrice     Float
  frequency   FREQUENCY
  qeriesCount Int       @default(0)
  isActive    Boolean   @default(true)
  isDeleted   Boolean   @default(false)
  users       User[]
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
}

model GoogleData {
  id             String  @id @default(auto()) @map("_id") @db.ObjectId
  sub            String
  name           String
  given_name     String
  family_name    String
  picture        String
  email          String  @unique
  email_verified Boolean
  User           User[]
}

model User {
  id             String     @id @default(auto()) @map("_id") @db.ObjectId
  name           String
  email          String     @unique
  password       String?
  phone          String?
  speciality     String?
  paidUser       Boolean    @default(false)
  activeUntil    DateTime?
  role           USER_TYPES @default(user)
  emailVerified  Boolean    @default(false)
  phoneVerified  Boolean    @default(false)
  autoRenewal    Boolean    @default(false)
  code           Int?
  socialProvider String?
  isBlocked      Boolean?   @default(false)
  isDeleted      Boolean?   @default(false)
  Plan           Plan?      @relation(fields: [planId], references: [id])
  planId         String?    @db.ObjectId

  Country   Country? @relation(fields: [countryId], references: [id])
  countryId String?  @db.ObjectId

  googleData   GoogleData? @relation(fields: [googleDataId], references: [id])
  googleDataId String?     @db.ObjectId

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([name, email, phone, paidUser])
}
